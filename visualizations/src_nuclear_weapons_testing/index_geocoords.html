<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">
  <style>
      body {
        font-family: 'Raleway', sans-serif;
        font-size: 20px;
      }
  </style>
</head>
<body>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://d3js.org/topojson.v1.min.js"></script>
  <!-- I recommend you host this file on your own, since this will change without warning -->
  <script src="http://datamaps.github.io/scripts/datamaps.world.min.js?v=1"></script>
  <h1>Nuclear weapons testing</h1>
  <h3>(Radius corresponds to number of tests)</h3>
  <div id="container1" style="position: relative; width: 80%; max-height: 500px;"></div>
  <div id="container2" style="position: relative; width: 100%; max-height: 200px;"></div>
 
     
     <script>
       //basic map config with custom fills, mercator projection
      var map = new Datamap({
        scope: 'world',
        element: document.getElementById('container1'),
        projection: 'mercator',
        height: 400,
        fills: {
          defaultFill: 'grey',
          lt50: 'rgba(0,244,244,0.9)',
          gt50: 'red'
        },
        
        data: {
          USA: {fillKey: 'lt50' }     
        }
      })
      

    var operationsList = [
       {'longitude': '162.34808', 'latitude': '11.55392', 'name': 'Military Effects on Operation REDWING', 'info': 'Type of test: barge, dry surface, free air drop, tower', 'period': '1956', 'fillKey': 'gt50', 'radius': 22, 'doc1': 'Title: forward and inverse modeling of near-field seismic waveforms from underground nuclear explosions for effective source functions and structure parameters (1987)', 'doc2': 'Title: parameter estimation for generator simulation studies (1977)', 'docid1': 'DocID: 31128', 'docid2': 'DocID: 309128', 'order': 0},
      {'longitude': '-116.0245', 'latitude': '37.0947', 'name': 'Operation Plumbbob', 'info': 'Type of test: balloon, dry surface, high alt rocket , tower, underground shaft, underground tunnel', 'period': '1957', 'fillKey': 'gt50', 'radius': 34, 'doc1': 'Title: operation Plumbbob project 33.2 secondary missiles generated by nuclear-produced blast waves (1963)', 'doc2': 'Title: operation Plumbbob project 2.2 neutron-induced activities in soil elements (1959)', 'docid1': 'DocID: 11843', 'docid2': 'DocID: 12229', 'order': 1},
      {'longitude': '-11.5', 'latitude': '-38.5', 'name': "Project Argus 'Greatest Experiment': 3 A-Blasts In Space, 1959/03/19", 'info': 'Type of test: space rocket', 'period': '1958', 'fillKey': 'gt50', 'radius': 8, 'doc1': 'Title: development of compositionally graded metallic glass alloys with desirable properties (2016)', 'doc2': 'Title: efficient elastic-plastic design of small foundations (1982)', 'docid1': 'DocID: 329407', 'docid2': 'DocID: 25608', 'order': 2},
      {'longitude': '-116.20863', 'latitude': '37.1879', 'name': 'Operation Nougat', 'info': 'Type of test: cratering, underground shaft, underground tunnel', 'period': '1961', 'fillKey': 'gt50', 'radius': 49, 'doc1': 'Title: operations Nougat, Flintlock, Latchkey, Bowline, and Emery (1972)', 'doc2': '', 'docid1': 'DocID: 7010', 'docid2': '', 'order': 3},
      {'longitude': '-116.04626', 'latitude': '37.17695', 'name': 'Operation Storax', 'info': 'Type of test: cratering, underground shaft, underground tunnel', 'period': '1962', 'fillKey': 'gt50', 'radius': 52, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 4},
      {'longitude': '-157.32', 'latitude': '1.59', 'name': 'Operation DOMINIC Nuclear Tests 1962', 'info': 'Type of test: air drop, free air drop, high-altitude rocket , parachuted, underwater', 'period': '1962', 'fillKey': 'gt50', 'radius': 36, 'doc1': 'Title: forward and inverse modeling of near-field seismic waveforms from underground nuclear explosions for effective source functions and structure parameters (1987)', 'doc2': 'Title: evaluation of fallout contamination from surface runoff (1969)', 'docid1': 'DocID: 31128', 'docid2': 'DocID: 318656', 'order': 4},
      {'longitude': '-116.30381', 'latitude': '37.11906', 'name': 'Operation Sunbeam', 'info': 'Type of test: cratering, dry surface, gun deployed, tower', 'period': '1962', 'fillKey': 'gt50', 'radius': 9, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 4},
      {'longitude': '-169.52534', 'latitude': '16.73365', 'name': 'Operation Fishbowl', 'info': 'Type of test: high-altitude rocket , space rocket', 'period': '1962', 'fillKey': 'gt50', 'radius': 14, 'doc1': 'Title: measurements of artificially injected electrons from satellite 1962 beta kappa (1963)', 'doc2': "Title: operation Dominic, Fish bowl series Project operator's report - Project 6.1 Fireball attenuation and refraction (1965)", 'docid1': 'DocID: 311933', 'docid2': 'DocID: 8462', 'order': 4},
      {'longitude': '-116.01644', 'latitude': '37.04164', 'name': 'Operation Niblick', 'info': 'Type of test: underground shaft', 'period': '1963', 'fillKey': 'gt50', 'radius': 46, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 5},
      {'longitude': '-116.04623', 'latitude': '37.18215', 'name': 'Operation Whetstone', 'info': 'Type of test: cratering, underground shaft, underground tunnel', 'period': '1964', 'fillKey': 'gt50', 'radius': 51, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 6},
      {'longitude': '-116.03304', 'latitude': '37.11495', 'name': 'Operation Flintlock', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1965', 'fillKey': 'gt50', 'radius': 52, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 7},
      {'longitude': '-116.13404', 'latitude': '37.14044', 'name': 'Operation Latchkey', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1966', 'fillKey': 'gt50', 'radius': 43, 'doc1': 'Title: operations Nougat, Flintlock, Latchkey, Bowline, and Emery (1972)', 'doc2': '', 'docid1': 'DocID: 7010', 'docid2': '', 'order': 8},
      {'longitude': '-116.0458', 'latitude': '37.1652', 'name': 'Operation Crosstie', 'info': 'Type of test: cratering, underground shaft, underground tunnel', 'period': '1967', 'fillKey': 'gt50', 'radius': 53, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 9},
      {'longitude': '-115.99962', 'latitude': '37.00095', 'name': 'Operation Bowline', 'info': 'Type of test: cratering, underground shaft, underground tunnel', 'period': '1968', 'fillKey': 'gt50', 'radius': 52, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 10},
      {'longitude': '-116.05599', 'latitude': '37.11939', 'name': 'Operation Mandrel', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1969', 'fillKey': 'gt50', 'radius': 57, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 11},
      {'longitude': '-116.03491', 'latitude': '37.1374', 'name': 'Operation Emery', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1970', 'fillKey': 'gt50', 'radius': 21, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 12},
      {'longitude': '-116.20427', 'latitude': '37.01148', 'name': 'Operation Grommet', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1971', 'fillKey': 'gt50', 'radius': 39, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 13},
      {'longitude': '-116.18382', 'latitude': '37.21439', 'name': 'Operation Toggle', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1972', 'fillKey': 'gt50', 'radius': 33, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 14},
      {'longitude': '-116.07413', 'latitude': '37.15903', 'name': 'Operation Arbor', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1973', 'fillKey': 'gt50', 'radius': 23, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 15},
      {'longitude': '-116.03269', 'latitude': '37.07498', 'name': 'Operation Bedrock', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1974', 'fillKey': 'gt50', 'radius': 32, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 16},
      {'longitude': '-116.02909', 'latitude': '37.02362', 'name': 'Operation Anvil', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1975', 'fillKey': 'gt50', 'radius': 26, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 17},
      {'longitude': '-116.06315', 'latitude': '37.13451', 'name': 'Fulcrum', 'info': 'Type of test: underground shaft', 'period': '1976', 'fillKey': 'gt50', 'radius': 26, 'doc1': 'Title: operation Fulcrum onsite radiological safety report October 1976 through September 1977 (1978)', 'doc2': '', 'docid1': 'DocID: 161709', 'docid2': '', 'order': 18},
      {'longitude': '-116.01741', 'latitude': '37.00759', 'name': 'Cresset', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1977', 'fillKey': 'gt50', 'radius': 27, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 19},
      {'longitude': '-116.29838', 'latitude': '37.28789', 'name': 'Quicksilver', 'info': 'Type of test: underground shaft', 'period': '1978', 'fillKey': 'gt50', 'radius': 21, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 20},
      {'longitude': '-116.02484', 'latitude': '36.99395', 'name': 'Tinderbox', 'info': 'Type of test: underground shaft', 'period': '1979', 'fillKey': 'gt50', 'radius': 19, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 21},
      {'longitude': '-116.20626', 'latitude': '37.21121', 'name': 'Guardian', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1980', 'fillKey': 'gt50', 'radius': 19, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 22},
      {'longitude': '-116.00962', 'latitude': '37.08156', 'name': 'Praetorian', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1981', 'fillKey': 'gt50', 'radius': 24, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 23},
      {'longitude': '-116.03272', 'latitude': '37.02323', 'name': 'Phalanx', 'info': 'Type of test: underground cavity in tunnel, underground shaft, underground tunnel', 'period': '1982', 'fillKey': 'gt50', 'radius': 23, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 24},
      {'longitude': '-116.04643', 'latitude': '37.01274', 'name': 'Fusileer', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1983', 'fillKey': 'gt50', 'radius': 21, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 25},
      {'longitude': '-116.0537', 'latitude': '37.08516', 'name': 'Grenadier', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1984', 'fillKey': 'gt50', 'radius': 21, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 26},
      {'longitude': '-116.20615', 'latitude': '37.20862', 'name': 'Charioteer', 'info': 'Type of test: underground cavity in tunnel, underground shaft, underground tunnel', 'period': '1985', 'fillKey': 'gt50', 'radius': 21, 'doc1': 'Title: operations Charioteer, Musketeer, Touchstone, Cornerstone, Aqueduct, Sculpin and Julin (1999)', 'doc2': '', 'docid1': 'DocID: 313241', 'docid2': '', 'order': 27},
      {'longitude': '-116.07957', 'latitude': '37.14185', 'name': 'Touchstone', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1987', 'fillKey': 'gt50', 'radius': 18, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 28},
      {'longitude': '-116.05013', 'latitude': '37.08895', 'name': 'Cornerstone', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1988', 'fillKey': 'gt50', 'radius': 16, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 29},
      {'longitude': '-116.49161', 'latitude': '37.26305', 'name': 'Aqueduct', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1989', 'fillKey': 'gt50', 'radius': 15, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 30},
      {'longitude': '-116.4951', 'latitude': '37.24781', 'name': 'Sculpin', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1990', 'fillKey': 'gt50', 'radius': 12, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 31},
      {'longitude': '-116.04616', 'latitude': '37.06338', 'name': 'Julin', 'info': 'Type of test: underground shaft, underground tunnel', 'period': '1991', 'fillKey': 'gt50', 'radius': 12, 'doc1': '', 'doc2': '', 'docid1': '', 'docid2': '', 'order': 32}
      ]
      

      var i = 0;                     //  set your counter to 0

      function mapLoop () {           //  create a loop function
         setTimeout(function () {    
            var operArray = [operationsList[i]];
            map.bubbles(operArray, {
                   popupTemplate: function(geo, data) {
                     var divObj = "<div class='hoverinfo'>" + data.info + "";
                     return divObj;
                   }
             });

            const myNode = document.getElementById('container2');
              while (myNode.firstChild) {
                  myNode.removeChild(myNode.firstChild);
                }    

            var year = operArray[0]['period'];
            var name = operArray[0]['name'];
            var info = operArray[0]['info'];
            var doc1 = operArray[0]['doc1'];
            var doc2 = operArray[0]['doc2'];
            var docid1 = operArray[0]['docid1'];
            var docid2 = operArray[0]['docid2'];

            var h = document.createElement("H2")
            var h1 = document.createElement("H2")
            var h2 = document.createElement("H3")
            var h3_1 = document.createElement("H3")
            var h4_1 = document.createElement("H4")
            var h3_2 = document.createElement("H3")
            var h4_2 = document.createElement("H4") 

            var yearnode = document.createTextNode(year + ' ' + name);
            var infonode = document.createTextNode(info);
            var doc1node = document.createTextNode(doc1 + ' ' + docid1);
            var doc2node = document.createTextNode(doc2 + ' ' + docid2);


            var secDiv = document.getElementById('container2');
            
            h.append(yearnode);
            secDiv.appendChild(h); 
            h2.append(infonode); 
            secDiv.appendChild(h2); 
            h3_1.append(doc1node); 
            secDiv.appendChild(h3_1); 
            h3_2.append(doc2node); 
            secDiv.appendChild(h3_2); 

            
            i++;                    
            if (i < operationsList.length) {            
               mapLoop();             
            }                       
         }, 3000)
      }

      mapLoop()


     </script>
</body>